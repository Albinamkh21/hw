<html lang="en">
<head>
    <link rel="stylesheet" href="main.css">
    <meta charset="UTF-8">
    <title>Drag&Drop</title>
</head>
<body>
<div id = 'container' >
  <input type="button"  id = btnCreator value = "Создать див"/>
</div>
</body>
</html>
<script>

    var container = document.getElementById('container');
    var btnCreator = document.getElementById('btnCreator');
    btnCreator.addEventListener('click', handler);
    function handler(e) {

        var div = document.createElement('div');
        div.style.backgroundColor = '#'+Math.random().toString(16).slice(2, 8).toUpperCase()
        div.style.width = getRandomInt(10,900)+'px';
        div.style.height = getRandomInt(10,800)+'px';
        div.style.top = getRandomInt(0,400)+'px';
        div.style.left = getRandomInt(10,400)+'px';
        div.setAttribute('class','divMovable');
        div.setAttribute('id','moveMe');
        container.appendChild(div);
        div.style.zIndex = 1000;
    };

    container.addEventListener('mousedown',function dragDiv(e){
        var target =  e.target;
        //console.log(target, e.type, target.id, e.screenX, e.screenY);
        if(target.id !='moveMe') return;

        var shiftX = e.pageX - getCoords(target).left;
        var shiftY = e.pageY - getCoords(target).top;
        moveAt(e);

        function moveAt(e) {
            target.style.left = e.pageX - shiftX + 'px';
            target.style.top = e.pageY - shiftY  + 'px';
        }
        document.onmousemove = function(e) {
            moveAt(e);
        };
        target.onmouseup = function() {
            document.onmousemove = null;
            target.onmouseup = null;
        };
    });

    //helpers
    function getCoords(elem) {
        var box = elem.getBoundingClientRect();

        return {
            top: box.top + pageYOffset,
            left: box.left + pageXOffset
        };

    }
     function getRandomInt(min, max)
     {
         return Math.floor(Math.random() * (max - min + 1)) + min;
     }


</script>